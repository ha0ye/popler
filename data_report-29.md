popler\_data\_organizatonal\_hierarchy
================
Hao Ye, Ellen Bledsoe
5/21/2019

``` r
library(tidyverse)

all_data <- readRDS("list_df.rds")
df <- as_tibble(all_data[[params$dataset_index]])

cat("My project metadata key is ", 
    df$proj_metadata_key[1], "!!")
```

    ## My project metadata key is  85 !!

``` r
# figure out the spatial replication levels
df %>% 
  select(starts_with("spatial_replication_level")) %>%
  NCOL() %>%
  {./2} -> num_sr_levels
```

``` r
# transform the names of the variables
#   - get rid of the `spatial_replication_level_#_label` columns
sr_vars <- character(num_sr_levels)
for (i in seq(num_sr_levels))
{
  new_name <- paste0(i, "--", df[1, paste0("spatial_replication_level_", i, "_label")])
  old_name <- paste0("spatial_replication_level_", i)
  sr_vars[i] <- new_name
  df <- rename(df, !!new_name := !!old_name)
}
```

``` r
# extract just the spatial replication level data
data_organization <- df %>%
  select(sr_vars)
```

``` r
# generate contingency tables to summarize organizational structure:
#   - level_i vs. level_j (i < j)

cols <- expand.grid(i = seq(num_sr_levels), 
                    j = seq(num_sr_levels)) %>%
  filter(i < j)

sr_tables <- purrr::pmap(cols, function(i, j) {
    data_organization %>%
      select(sr_vars[c(i, j)]) %>%
      table()
  })
```

``` r
# loop over tables and output
purrr::map(sr_tables, knitr::kable)
```

    ## [[1]]
    ## 
    ## 
    ##                           0.0   0.05   0.1   0.15   0.2   0.25   0.3   0.35   0.4   0.45   0.5   0.55   0.6   0.65   0.7   0.75   0.8   0.85   0.9   0.95   1.0   10.0   10.05   10.1   10.15   10.2   10.25   10.3   10.35   10.4   10.41   10.45   1.05   10.5   10.6   10.7   10.75   10.8   10.85   10.9   10.95   1.1   11.0   11.05   1.11   11.1   11.15   11.2   11.225   11.25   11.3   11.35   11.4   1.15   11.5   11.55   11.6   11.65   11.7   11.8   11.85   11.9   1.2   12.0   12.1   12.15   12.2   12.25   12.3   12.4   1.25   12.5   12.55   12.6   12.65   12.7   12.75   12.8   12.85   12.9   12.95   1.3   13.0   13.1   13.15   13.2   13.25   13.3   13.35   13.4   13.45   1.35   13.5   13.55   13.6   13.65   13.7   13.75   13.8   13.85   13.9   13.95   1.4   14.0   14.05   14.1   14.15   14.2   14.25   14.3   14.35   14.4   14.45   1.45   14.5   14.55   14.6   14.65   14.7   14.75   14.8   14.85   14.9   1.5   15.0   15.05   15.1   15.15   15.2   15.25   15.3   15.35   15.4   1.55   15.5   15.55   15.6   15.65   15.7   15.75   15.8   15.85   15.9   15.95   1.6   16.0   16.1   16.15   16.2   16.25   16.3   16.35   16.4   16.45   1.65   16.5   16.6   16.65   16.7   16.75   16.8   16.85   16.9   16.95   1.7   17.0   17.05   17.1   17.2   17.25   17.3   17.35   17.4   17.41   17.45   17.5   17.55   17.6   17.7   17.8   17.85   17.9   17.95   1.8   18.0   18.1   18.15   18.2   18.25   18.3   18.35   18.4   1.85   18.5   18.55   18.6   18.65   18.7   18.8   1.89   18.9   1.9   19.0   19.1   19.2   19.25   19.3   19.35   19.4   19.45   1.95   19.5   19.55   19.6   19.65   19.7   19.75   19.8   19.9   19.95   2.0   20.0   20.1   20.15   20.2   20.3   20.4   20.45   20.5   20.6   20.7   2.1   2.15   2.2   2.25   2.3   2.35   2.4   2.45   2.5   2.55   2.6   2.65   2.7   2.75   2.8   2.85   2.9   2.95   3.0   3.05   3.1   3.15   3.2   3.25   3.3   3.35   3.4   3.45   3.5   3.55   3.6   3.65   3.7   3.75   3.8   3.85   3.9   3.95   4.0   4.05   4.1   4.15   4.16   4.18   4.2   4.25   4.3   4.35   4.4   4.45   4.5   4.55   4.6   4.65   4.67   4.7   4.75   4.8   4.85   4.9   4.95   5.0   5.05   5.1   5.2   5.25   5.3   5.34   5.35   5.4   5.45   5.5   5.55   5.6   5.65   5.7   5.75   5.8   5.85   5.9   5.95   6.0   6.1   6.15   6.2   6.25   6.3   6.35   6.4   6.45   6.5   6.55   6.6   6.65   6.7   6.75   6.8   6.85   6.9   6.95   7.0   7.05   7.1   7.15   7.2   7.25   7.3   7.35   7.4   7.5   7.55   7.6   7.65   7.7   7.8   7.85   7.9   8.0   8.05   8.1   8.15   8.2   8.25   8.3   8.35   8.4   8.45   8.5   8.55   8.6   8.65   8.7   8.75   8.8   8.85   8.9   8.95   9.0   9.05   9.1   9.15   9.2   9.25   9.3   9.35   9.4   9.5   9.6   9.65   9.7   9.75   9.8   9.9   9.95   NA
    ## -----------------------  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ------  -----  ------  -----  ------  -----  ------  -----  ------  ------  -----  -----  -----  -----  ------  -----  ------  -----  ------  ----  -----  ------  -----  -----  ------  -----  -------  ------  -----  ------  -----  -----  -----  ------  -----  ------  -----  -----  ------  -----  ----  -----  -----  ------  -----  ------  -----  -----  -----  -----  ------  -----  ------  -----  ------  -----  ------  -----  ------  ----  -----  -----  ------  -----  ------  -----  ------  -----  ------  -----  -----  ------  -----  ------  -----  ------  -----  ------  -----  ------  ----  -----  ------  -----  ------  -----  ------  -----  ------  -----  ------  -----  -----  ------  -----  ------  -----  ------  -----  ------  -----  ----  -----  ------  -----  ------  -----  ------  -----  ------  -----  -----  -----  ------  -----  ------  -----  ------  -----  ------  -----  ------  ----  -----  -----  ------  -----  ------  -----  ------  -----  ------  -----  -----  -----  ------  -----  ------  -----  ------  -----  ------  ----  -----  ------  -----  -----  ------  -----  ------  -----  ------  ------  -----  ------  -----  -----  -----  ------  -----  ------  ----  -----  -----  ------  -----  ------  -----  ------  -----  -----  -----  ------  -----  ------  -----  -----  -----  -----  ----  -----  -----  -----  ------  -----  ------  -----  ------  -----  -----  ------  -----  ------  -----  ------  -----  -----  ------  ----  -----  -----  ------  -----  -----  -----  ------  -----  -----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  -----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  ----  -----  ----  -----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  ----  -----  ----  -----  ----  ----  -----  ----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  -----  ----  ----  ----  -----  ----  -----  ----  ----  -----  ---
    ## site_sgs_road_transect     12      2    17      5    12     20    31     15    23      5    32     12    19      7    27      5     8      6    21      5    18      6       1      1       2      3       4      8       3      7       1       1      1      5      2      6       2      6       2     15       2     9      5       1      1      5       1      5        1       3      4       2      5      3      1       3     11       1      5      9       1      6    10      5      7       1      5       1     10      6      4      8       2      6       1      6       4     10       5      9       1     4      3     12       2      7       3      8       3      4       2      4      5       4      4       2      9       5      8       2      7       3     8      7       3      8       2     10       3      6       1      9       3      2     12       5      9       2     21       3     15       3     12     6      9       2      8       2     12       2     15       4      6      8      8       1      6       2     12       5     11       4      5       3    24      8      2       3     10       1     12       1      9       3      5      6      5       1      3       1      4       2     15       1    14      6       1      7      6       1      9       2     11       1       1     11       3      4     12      8       5      6       1     8      7      6       1      3       1      6       1      3      1      4       1      9       2      5      3      1      8    10      5      6      8       1      3       1      4       2      3      4       1      7       3      7       3      8      1       2     9      6     10       1      2      5      8       2      7      2      1    17      3    10      4     9      3     9      1    10      2     6      1     6      2     5      3    12      1    15      2     5      5    11      3    10      2    11      2    12      2     8      4    13      3     8      5    15      1    17      1    12      4      1      1    12      4    17      2    16      3    14      1    14      2      1    14      4    14      3    16      2    16      1    14     9      7    22      1      4    11      1    13      3    11      3    17      6    24      3    20      2    10     8      1     6      2     6      2     7      1     7      1     8      2     6      4     5      3    13      1     8      2     5      1     3      2     8      1     8     8      1     5      1     5     7      1    14    12      2    14      1    13      1    11      2     8      1     9      3     9      1    14      3    10      4    14      3    20      1    10      1     4      3    10      1     2     1     8      2    10      1     6     8      4    4
